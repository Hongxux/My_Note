---
aliases:
  - slow query log
---
> ​**慢查询日志记录了所有执行时间超过参数 `long_query_time`设定值，并且扫描记录数不小于 `min_examined_row_limit`设定值的所有 SQL 语句。​**​

- ​**核心作用**​：它不是记录所有查询，而是像一个“**性能探测器**”，专门捕捉那些执行效率低下的“慢SQL”。
    
- ​**默认状态**​：​**默认是关闭的**，需要手动开启，因为记录日志本身也有性能开销。
    
#### 配置慢查询日志(重启生效)
```sql
show variables like '%quer%';
```
![[Pasted image 20251029201854.png]]

将 slow_query_log 全局变量设置为“ON”状态 ，临时生效，mysql重启后就会失效
```
set global slow_query_log='ON';
```
设置慢查询日志存放的位置
```
set global slow_query_log_file='D:\\kpdata\\DataBase\\Data\\mysql.log';
```
找到mysql的安装目录，找到my.ini文件夹在[mysqld]处加入以下代码开启慢查询，永久有效。


​**1. 开启慢查询日志总开关**​

```
slow_query_log=1
```

- ​**作用**​：设置为 `1`来**开启**慢查询日志功能。设置为 `0`则关闭。
    

​**2. 设置慢查询的时间阈值**​

```
long_query_time=2
```

- ​**作用**​：定义“慢”的标准。单位是**秒**，可以精确到微秒（如 `1.5`表示1.5秒）。
    
- ​**图中说明**​：默认值为 10 秒，图中设置为 2 秒。这意味着任何执行时间超过 2 秒的 SQL 语句都会被记录到慢查询日志中。
    

​**3. 记录未使用索引的查询**​

```
log_queries_not_using_indexes=1
```

- ​**作用**​：即使查询执行得很快，但如果它**没有使用索引**，也会被记录下来。
    
- ​**重要性**​：这是发现潜在全表扫描、优化索引设计的**重要工具**。例如，一个在少量数据上运行很快的全表扫描，当数据量增长后就会成为性能灾难。
    

​**4. 记录管理语句**​

```
log_slow_admin_statements=1
```

- ​**作用**​：记录执行缓慢的**管理类语句**，如 `OPTIMIZE TABLE`、`ANALYZE TABLE`、`ALTER TABLE`等。
    

7、重启服务，查看慢查询开启状态。

#### 直接去文件中看mysql
![[Pasted image 20251029212331.png]]






