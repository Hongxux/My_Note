### [[多表关系]]
![[Pasted image 20251029123842.png]]
### 多表查询概述
####  笛卡尔积
![[Pasted image 20251029125936.png]]
 ![[Pasted image 20251029125924.png]]
##### 消除无效的笛卡尔积
![[Pasted image 20251029130135.png]]
#### 多表查询的分类
- 内连接：查询A、B交集部分数据。

- 外连接：

	- 左外连接：查询左表所有数据及两表交集。
	
	- 右外连接：查询右表所有数据及两表交集。
	
- 自连接：当前表与自身的连接，需使用表别名。
### 内连接


#### 隐式内连接

```
SELECT 字段列表 FROM 表1, 表2 WHERE 条件...;
```

#### 显式内连接

```
SELECT 字段列表 FROM 表1 [INNER] JOIN 表2 ON 连接条件...;
```

#### 关键区别

- ​**语法结构**​：隐式使用逗号分隔表，显式使用JOIN关键字
    
- ​**条件位置**​：隐式条件在WHERE子句，显式条件在ON子句
    
- ​**可读性**​：显式语法更清晰，推荐使用
    
- ​**功能等价**​：两种语法查询结果完全相同

### 外连接

##### ​**外连接核心概念**​

外连接用于查询两个表的关联数据，​**并包含其中一个表的全部记录**​（即使另一个表没有匹配项）。缺失匹配时，另一表的字段显示为 `NULL`。

##### ​**1. 左外连接 (LEFT OUTER JOIN)​**​

- ​**语法**​：
    
    ```
    SELECT 字段列表 
    FROM 表1 
    LEFT [OUTER] JOIN 表2 ON 连接条件;
    ```
    
- ​**效果**​：
    
    返回**左表（表1）的全部数据**​ + 与右表（表2）的交集数据。
    
    若右表无匹配，右表字段自动补 `NULL`。
    
- ​**示例**​：
    
    查询所有员工及其部门（包括未分配部门的员工）：
    
    ```
    SELECT e.name, d.dept_name 
    FROM employees e 
    LEFT JOIN departments d ON e.dept_id = d.id;
    ```
    

##### ​**2. 右外连接 (RIGHT OUTER JOIN)​**​

- ​**语法**​：
    
    ```
    SELECT 字段列表 
    FROM 表1 
    RIGHT [OUTER] JOIN 表2 ON 连接条件;
    ```
    
- ​**效果**​：
    
    返回**右表（表2）的全部数据**​ + 与左表（表1）的交集数据。
    
    若左表无匹配，左表字段自动补 `NULL`。
    
- ​**示例**​：
    
    查询所有部门及其员工（包括无员工的部门）：
    
    ```
    SELECT d.dept_name, e.name 
    FROM employees e 
    RIGHT JOIN departments d ON e.dept_id = d.id;
    ```
    

---

##### ​**关键点总结**​

|连接类型|核心规则|适用场景|
|---|---|---|
|​**左外连接**​|保留左表全部数据|分析主体数据及其关联项（如所有用户及其订单）|
|​**右外连接**​|保留右表全部数据|分析被关联表的完整情况（如所有产品及其销售记录）|

- ​**OUTER 关键字可省略**​：`LEFT JOIN`与 `LEFT OUTER JOIN`等价。
    
- ​**文氏图理解**​：
    
    - 左外连接 = 左表完整圆圈 + 交集部分
        
    - 右外连接 = 右表完整圆圈 + 交集部分
        
    

---

##### ​**注意事项**​

1. 确保连接条件准确（如 `ON e.dept_id = d.id`），避免误关联。
    
2. 处理 `NULL`值：外连接结果中未匹配的字段为 `NULL`，需在查询中使用 `COALESCE()`或 `IFNULL()`处理。
    
3. 性能优化：对连接字段建立索引可加速查询。
    

通过左外连接和右外连接，可以灵活分析数据的完整关联情况，是数据库查询中的重要工具。
### [[自连接]]

### [[联合查询]]

### [[子查询]]

