要真正理解一个文件系统的工作原理，建议从以下两个相互关联的方面入手。掌握这两点，就意味着你建立了关于该文件系统的正确“心智模型”。

#### ​**1. 文件系统的数据结构**​

这是指文件系统在持久化存储设备（如磁盘）上用于组织和存储**数据**与**元数据**的静态结构。

- ​**基本形式**​：简单的文件系统（如后文将介绍的 `vsfs`）可能采用简单的结构，例如**块数组**或线性表。
    
- ​**高级形式**​：复杂的文件系统（如 SGI 的 XFS）则会使用更精细的结构，例如**基于树的数据结构**，以实现更高的性能和可扩展性。
    
- ​**核心问题**​：你的心智模型需要能够回答：“文件系统的数据和元数据是由哪些磁盘上的结构存储的？”
    

#### ​**2. 文件系统的访问方法**​

这是指文件系统如何将应用程序发出的**动态操作请求**​（系统调用）映射到对上述静态数据结构的实际操作上。

- ​**操作映射**​：它定义了当进程调用 `open()`, `read()`, `write()`, `close()`等系统调用时，文件系统内部会执行哪些步骤，以及会访问（读取或写入）哪些特定的磁盘数据结构。
    
- ​**性能考量**​：同时，还需要分析这些访问路径的**效率**如何。例如，完成一次文件读取需要访问多少次磁盘？
    
- ​**核心问题**​：你的心智模型需要能够描述：“当执行一个特定的系统调用时，哪些磁盘结构会被读取？哪些会被写入？这个过程效率如何？”
    

#### ​**目标：构建正确的“心智模型”​**​

理解以上两个方面的最终目的，是构建一个抽象而准确的**心智模型**。

- ​**超越代码**​：这个模型让你能够超越具体代码的细节，从概念层面理解文件系统内部发生的真实情况。
    
- ​**系统思维**​：这是“系统思维”的关键组成部分。通过不断思考和完善你的心智模型，你不仅能知道某个文件系统“怎么做”，更能理解它“为什么这样设计”，从而能够更好地分析、比较甚至预测不同文件系统的行为。