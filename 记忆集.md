---
aliases:
  - RSet
---
- 需求背景：在串行和并行收集器中，GC通过整堆扫描，来确定对象是否处于可达路径中
	- 全表扫描耗时长
- 解决措施：使用`Remembered Set`来避免全堆扫描
	- 在回收一个Region的时候不需要执行全堆扫描，只需要检查它的RS就可以找到外部引用，而这些引用就是初始标记的根之一。
- 记录内容：记录引用分区`Region`内对象的卡片`Card`的索引（记录哪些Region中的对象指向了当前分区中的对象）
	- xx Region的 xx Card
	- 只有老年代的分区`Region`可能会有RSet记录
		- G1 GC每次都会对年轻代进行整体收集，因此引用源自年轻代的对象，不需要在`RSet`记录
- 问题：
	- RSet本身需要占用额外的内存空间（通常为堆大小的10%-20%）
	- 并且程序运行过程中，每次写引用字段时，JVM都需要插入一个**写屏障**​ 来维护RSet的更新，这会带来一定的性能损耗