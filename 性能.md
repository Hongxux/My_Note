### 性能的指标是什么
性能是可以通过一系列可量化的指标来衡量的。主要分为两大类：**面向业务的指标**和**面向资源的指标**。
**业务指标（外部）**：响应时间、吞吐量、并发数。  
**资源指标（内部）**：CPU、内存、磁盘I/O、网络I/O使用率。
#### 1. 面向业务的指标（用户和业务方最关心的）

这些指标直接关系到用户体验和业务能力。

- **响应时间 / 延迟**
    
    - **定义**：从发出请求到接收到完整响应所花费的时间。
        
    - **细节**：通常我们关注**平均响应时间**，但更重要的是**百分位数**，如 P95、P99。P99 响应时间为 200ms 表示 99% 的请求都在 200ms 内返回，这能反映出长尾请求的体验，避免平均值“看起来很美”的假象。
        
    
- **吞吐量**
    
    - **定义**：单位时间内系统能成功处理的请求数量。
        
    - **常用单位**：QPS（每秒查询数）、RPS（每秒请求数）、TPS（每秒事务数）。
        
    - **重要性**：它直接衡量系统的处理能力。在延迟可接受的范围内，吞吐量越高越好。
        
    
- **并发数**
    
    - **定义**：系统同时能处理的请求数量。
        
    - **关系**：吞吐量 ≈ 并发数 / 平均响应时间。在系统稳定时，并发数越高，吞吐量通常也越高，但超过某个临界点后，响应时间会急剧增加，吞吐量反而会下降。
        
    

#### 2. 面向资源的指标（开发和运维人员最关心的）

这些指标反映了系统的健康度和资源消耗情况。

- **CPU 使用率**
    
    - **说明**：CPU 的繁忙程度。如果持续高于80%，可能成为瓶颈。
        
    
- **内存使用率**
    
    - **说明**：系统内存的占用情况。过高可能导致频繁的磁盘交换（SWAP），极大降低性能，甚至引发OOM（内存溢出）导致服务崩溃。
        
    
- **磁盘 I/O**
    
    - **指标**：读写速率（KB/s）、IOPS（每秒读写操作次数）、磁盘使用率。
        
    - **说明**：对于数据库等密集型应用，磁盘I/O是常见瓶颈。
        
    
- **网络 I/O**
    
    - **指标**：网络带宽占用（Mbps）、网络连接数、包量。
        
    - **说明**：对于高流量服务，网络带宽可能成为瓶颈。
        
    
- **错误率**
    
    - **定义**：失败请求数占总请求数的比例。
        
    - **说明**：性能下降往往伴随着错误率的上升（如超时、连接失败）。

---
### 性能差代表什么？
1. **糟糕的用户体验**
    
    - 页面加载缓慢、点击无响应、视频卡顿。
        
    - **后果**：用户流失。据谷歌等机构研究，页面加载延迟**每增加100毫秒**，转化率就会显著下降。用户会转向你的竞争对手。
        
    
2. **直接的经济损失**
    
    - 对于电商网站，性能差直接导致订单减少、销售额下降。
        
    - 对于广告业务，吞吐量低意味着展示的广告次数少，收入减少。
        
    - 服务器资源利用率高，意味着需要采购更多、更贵的硬件来维持服务，**成本增加**。
        
    
3. **系统稳定性和可扩展性风险**
    
    - 性能差通常意味着系统已接近其容量极限。当遇到流量高峰（如促销活动、热点新闻），系统无法扩展，容易发生**雪崩效应**，导致整个服务不可用。
        
    - 一个请求处理慢，可能会占用连接池、数据库连接等资源，进而拖慢所有其他请求，引发连锁故障。
        
    
4. **阻碍业务发展和创新**
    
    - 开发新功能时，如果底层系统性能低下，任何新特性都可能成为“压垮骆驼的最后一根稻草”，使得迭代和创新举步维艰。