- 假设使用强引用![[Pasted image 20251203230742.png]]
	- 图中实线代表强引用
	- 背景：
		- ThreadLocal使用完之后，ThreadLocalRef被回收，相关强引用断开
		- 线程还在运行，相关强引用还存在
		- 没有用remove删除enrty
	- 后果：无用的Enrty（key为ThreadLocal对象）仍然不会被回收，造成内存泄露
- 假设使用弱引用![[Pasted image 20251203231419.png]]
	- 图中实线代表强引用，虚线表示弱引用
	- 背景：
		- ThreadLocal使用完之后，ThreadLocalRef被回收，相关强引用断开
		- 线程还在运行，相关强引用还存在
		- 没有用remove删除enrty
	- 后果：
		- ThreadLocal被回收
			- 无用的Enrty key为null
		- 无用的Enrty仍然不会被回收，造成内存泄露
- 结论：无论使用强引用还是弱引用都会导致内存泄露
