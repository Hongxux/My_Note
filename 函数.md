![[Pasted image 20251029085022.png]]
### 字符串函数 
| 函数                       | 功能                                         |
| ------------------------ | ------------------------------------------ |
| CONCAT(S1,S2,...Sn)      | 字符串拼接，将S1，S2，...Sn拼接成一个字符串                 |
| LOWER(str)               | 将字符串str全部转为小写                              |
| UPPER(str)               | 将字符串str全部转为大写                              |
| LPAD(str,n,pad)          | 左填充，用字符串pad对str的左边进行填充，达到n个字符串长度           |
| RPAD(str,n,pad)          | 右填充，用字符串pad对str的右边进行填充，达到n个字符串长度           |
| TRIM(str)                | 去掉字符串头部和尾部的空格                              |
| SUBSTRING(str,start,len) | 返回从字符串str从start位置起的len个长度的字符串（字符串第一个是位置是1） |
![[Pasted image 20251029090534.png]]
### 数值函数
| 函数                | 功能说明               | 语法示例                       | 返回值示例       |
| ----------------- | ------------------ | -------------------------- | ----------- |
| ​**CEIL(x)​**​    | 向上取整（返回大于等于x的最小整数） | `SELECT CEIL(3.14);`       | 4           |
| ​**FLOOR(x)​**​   | 向下取整（返回小于等于x的最大整数） | `SELECT FLOOR(3.14);`      | 3           |
| ​**MOD(x,y)​**​   | 返回x除以y的模（余数）       | `SELECT MOD(10,3);`        | 1           |
| ​**RAND()​**​     | 返回0~1之间的随机浮点数      | `SELECT RAND();`           | 0.7634（随机值） |
| ​**ROUND(x,y)​**​ | 对x进行四舍五入，保留y位小数    | `SELECT ROUND(3.14159,2);` | 3.14        |

### 日期函数
#### **1. 当前时间获取函数**​

|函数|语法|返回示例|描述|
|---|---|---|---|
|​**CURDATE()​**​|`SELECT CURDATE();`|`2023-10-27`|返回当前日期（不含时间）|
|​**CURTIME()​**​|`SELECT CURTIME();`|`14:30:25`|返回当前时间（不含日期）|
|​**NOW()​**​|`SELECT NOW();`|`2023-10-27 14:30:25`|返回当前完整日期时间|

#### ​**2. 日期部分提取函数**​

|函数|语法示例|返回值|应用场景|
|---|---|---|---|
|​**YEAR(date)​**​|`SELECT YEAR('2023-10-27');`|`2023`|年度报表统计|
|​**MONTH(date)​**​|`SELECT MONTH('2023-10-27');`|`10`|月度数据分析|
|​**DAY(date)​**​|`SELECT DAY('2023-10-27');`|`27`|日期维度分析|

#### ​**3. 日期计算函数**​

| 函数                                        | 语法                                                   | 功能说明       |
| ----------------------------------------- | ---------------------------------------------------- | ---------- |
| ​**DATE_ADD(date, INTERVAL expr type)​**​ | `SELECT DATE_ADD(NOW(), INTERVAL 7 DAY/MONTH/YEAR);` | 日期加时间间隔    |
| ​**DATEDIFF(date1, date2)​**​             | `SELECT DATEDIFF('2023-12-31', '2023-10-27');`       | 计算两个日期相差天数 |
### 流程函数


#### ​**1. IF 函数 - 简单条件判断**​

​**语法：​**​ `IF(condition, value_if_true, value_if_false)`

​**应用示例：​**​

```
-- 用户VIP状态判断
SELECT 
    username,
    account_balance,
    IF(account_balance > 1000, '高价值客户', '普通客户') AS customer_level
FROM users;

-- 商品库存状态
SELECT 
    product_name,
    stock_quantity,
    IF(stock_quantity > 0, '有货', '缺货') AS stock_status
FROM products;
```

#### ​**2. IFNULL 函数 - 空值处理**​

​**语法：​**​ `IFNULL(expression, replacement_value)`

​**应用示例：​**​

```
-- 处理可能为NULL的邮箱地址
SELECT 
    username,
    IFNULL(email, '未填写邮箱') AS contact_email
FROM users;

-- 商品折扣计算（处理NULL折扣）
SELECT 
    product_name,
    price,
    IFNULL(discount, 0) AS actual_discount,
    price * (1 - IFNULL(discount, 0)) AS final_price
FROM products;
```

#### ​**3. CASE WHEN 两种形式详解**​

##### ​**形式一：条件判断型（搜索型）​**​

​**语法：​**​

```
CASE
    WHEN condition1 THEN result1
    WHEN condition2 THEN result2
    ...
    ELSE default_result
END
```

​**应用示例：​**​

```
-- 用户年龄分段
SELECT 
    username,
    birth_date,
    CASE
        WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) < 18 THEN '未成年'
        WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 18 AND 35 THEN '青年'
        WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 36 AND 60 THEN '中年'
        ELSE '老年'
    END AS age_group
FROM users;

-- 订单金额等级分类
SELECT 
    order_id,
    total_amount,
    CASE
        WHEN total_amount < 100 THEN '小额订单'
        WHEN total_amount BETWEEN 100 AND 500 THEN '中等订单'
        WHEN total_amount > 500 THEN '大额订单'
        ELSE '金额异常'
    END AS order_level
FROM orders;
```

##### ​**形式二：等值判断型**​

​**语法：​**​

```
CASE expression
    WHEN value1 THEN result1
    WHEN value2 THEN result2
    ...
    ELSE default_result
END
```

​**应用示例：​**​

```
-- 订单状态翻译
SELECT 
    order_id,
    status,
    CASE status
        WHEN 'Pending' THEN '待处理'
        WHEN 'Shipped' THEN '已发货'
        WHEN 'Delivered' THEN '已送达'
        WHEN 'Cancelled' THEN '已取消'
        ELSE '状态未知'
    END AS status_cn
FROM orders;

-- 商品类别分类
SELECT 
    product_name,
    category,
    CASE category
        WHEN 'Electronics' THEN '电子产品'
        WHEN 'Clothing' THEN '服装'
        WHEN 'Books' THEN '图书'
        WHEN 'Home' THEN '家居'
        WHEN 'Beauty' THEN '美妆'
        ELSE '其他'
    END AS category_cn
FROM products;
```



#### ​**何时使用哪个函数？​**​

|场景|推荐函数|理由|
|---|---|---|
|​**简单的二选一**​|`IF()`|代码简洁，易读性强|
|​**处理NULL值**​|`IFNULL()`|专为NULL处理设计|
|​**多个条件判断**​|`CASE WHEN`（搜索型）|支持复杂逻辑|
|​**枚举值匹配**​|`CASE WHEN`（等值型）|类似编程中的switch语句|

#### ​`**性能优化建议**​

```
-- 避免在WHERE条件中使用条件函数（索引失效）
-- 错误示例
SELECT * FROM products 
WHERE IF(stock_quantity > 0, '有货', '缺货') = '有货';

-- 正确示例
SELECT * FROM products WHERE stock_quantity > 0;
````
