---
aliases:
  - cpu占用过多
  - 线程死锁问题排查
---
- 案例一：cpu占用过多
	1. 定位进程（获得pid）：使用top 命令查看进程对cpu的占用情况![[Pasted image 20251205135446.png]]
	2. 定位进程中具体的线程（获得tid）：使用`ps H -eo pid,tid,%cpu | grep pid = 32655`
	3. 根据pid 和 tid 找问题代码行数：`jstack 32655`列出jvm中的进程的每个线程的信息，最后定位到有问题的代码行数![[Pasted image 20251205140148.png]]
		- jstack的tid是十六进制的，ps中的tid是十进制，需要先换算才能找到
		- 可以定位出现问题的代码行数![[Pasted image 20251205140655.png]]![[Pasted image 20251205140634.png]]
- 案例二：程序运行很长时间没有结果,可能出现线程死锁 
	1. 使用jstack查看这个进程
	2. 观察输出的开头和结尾是否有提示死锁![[Pasted image 20251205141008.png]]