- 需求背景

| 需求背景 | 核心关切 | 默认拒绝策略的不足 | 自定义策略的目标 |
| :--- | :--- | :--- | :--- |
| **系统稳定性与防雪崩** | 避免因任务拒绝导致请求线程阻塞或异常蔓延，引发级联故障。 | `AbortPolicy` 直接抛出异常，可能打满调用线程；`CallerRunsPolicy` 可能拖慢请求处理线程。 | 快速失败或进行服务降级，充当系统内部的“熔断器”，防止故障扩散。 |
| **业务连续性与数据完整性** | 确保核心业务或不可丢失的任务（如支付订单）在任何情况下都能被处理。 | `DiscardPolicy` 和 `DiscardOldestPolicy` 会静默丢弃任务，可能导致数据丢失或业务中断而无感知。 | 实现任务持久化、转移或异步重试机制，保证关键任务不丢失。 |
| **用户体验与可控降级** | 在系统过载时，向用户返回清晰的友好提示，而非生硬的错误代码。 | 默认策略无法与业务逻辑结合，无法返回具引导性的降级页面或提示。 | 根据任务类型返回不同的降级结果，提升用户体验，维护企业形象。 |
| **可观测性与快速响应** | 当拒绝发生时，需要及时告警并记录详细上下文，以便快速定位问题。 | 默认策略仅在日志中输出简单信息，缺乏有效监控和告警，容易错过处理时机。 | 集成监控告警系统，记录任务详情，帮助开发人员快速发现和解决问题。 |
| **资源优化与成本控制** | 根据任务优先级智能决策，在资源有限时优先保障高价值任务。 | 所有任务被平等对待，可能因低优先级任务堆积导致高优先级任务无法执行。 | 实现基于优先级的淘汰机制，优化资源利用，确保资源投向关键业务。 |

- 常见的自定义策略模式
	1.  **持久化与重试模式**：将拒绝的任务存入数据库或消息队列，后续异步重试。适用于支付、订单等关键业务。
	2.  **服务降级与熔断模式**：与熔断器（如Hystrix、Sentinel）结合，当拒绝次数超过阈值时，自动触发熔断，直接返回降级方案（如默认推荐、友好提示）。
	3.  **优先级调度模式**：结合优先级队列（`PriorityBlockingQueue`），在拒绝时根据策略（如淘汰最旧或最低优先级的任务）移除队列中的任务，以接纳新任务。
	4.  **饱和转嫁模式**：将拒绝的任务转移到一个专用的、处理能力较弱的“备胎”线程池或服务中去处理，为核心业务留出资源。

