### record 简介
**设计思路：use a record instead of a class for immutable data**
- ​**record的定义**​：record是一种特殊类，用于声明不可变的数据载体。例如，`record Point(double x, double y) { }`自动生成私有 final字段、构造器、访问器方法（x()和y()）以及toString、equals和hashCode方法。
    ![[Pasted image 20251017151636.png]]
    ![[Pasted image 20251017151651.png]]
    ![[Pasted image 20251017151708.png]]
	- **自定义功能**​：可以向record中**添加自定义方法**（如distanceFromOrigin）和**静态成员**（如静态字段或方法），但不能添加实例字段。
	-  ​**注意事项**​：如果record字段是可变对象（如Date），尽管引用不可变，对象内容可能被修改，因此需谨慎选择字段类型以保持不可变性。   
- ​**使用场景**​：record最适合纯数据载体，其中数据完全由一组变量描述且不可变；对于可变数据或可能演变的表示，应使用传统类。
- **优点：**
	- ​**自动生成的方法**​：record自动提供规范构造器、访问器（方法名与字段名相同，如x()而非getX()）、以及常用对象方法，**减少了样板代码**。
    
	- ​**不可变性**​：record的字段是隐式final的，确保对象状态在创建后不可变，提高了线程安全性和可预测性。  
​
### record的三种构造器
#### 规范构造器（canonical constructor）
自动生成的构造器（隐式的），用于初始化所有record组件字段。例如，在`record Point(double x, double y)`中，编译器自动生成一个接受所有字段参数的构造器。
#### 自定义构造器（custom constructors）
允许定义额外的构造器，**但第一个语句必须调用其他构造器**（如`this(...)`），以确保最终调用规范构造器。例如，Point record中添加的无参构造器`public Point() { this(0, 0); }`，用于创建原点对象。
- **使用场景：** 自定义构造器用于提供便捷的初始化方式（如默认值）
#### 紧凑构造器（compact constructor）
一种特殊语法，**不声明参数列表**，用于在**字段赋值前执行验证或调整逻辑**。例如，Range record中的紧凑构造器检查并交换`from`和`to`参数，确保`from <= to`。紧凑构造器只能修改参数变量，不能访问实例字段（因为字段尚未初始化）。
- **本质：** 在编译的时候，紧凑构造器的主体被**插入**到规范构造器的开端，因此主要对字段赋值前执行验证或调整逻辑，而且不可以访问实例字段，只能修改参数变量
- **使用场景：** 紧凑构造器用于业务逻辑验证（如参数排序）。 
### 例子
![[Pasted image 20251017152748.png]]