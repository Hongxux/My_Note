---
aliases:
  - 数据库备份
---
![[Pasted image 20251101215847.png]]
- 需求背景：
	- ​全库逻辑备份​：确保备份期间数据一致性，获取一个逻辑时间点的一致性视图
	- ​数据迁移或维护​：防止在关键操作过程中数据被修改，保证数据完整性。
- 解决措施：加全局锁，让数据库实例处于只读状态，所有数据修改操作将被阻塞
    - DML 写操作（如 `INSERT`、`UPDATE`、`DELETE`）
    - DDL 操作（如 `CREATE`、`ALTER`、`DROP`）
    - 事务提交（如 `COMMIT`）
- 使用实例：
	1. 加锁：立即关闭所有打开的表，并对整个数据库加全局读锁。
		```
		FLUSH TABLES WITH READ LOCK;
		```
	    - 需要 `RELOAD`权限
	    - 锁会持续到显式解锁或会话结束
	2. [[数据库备份]]
	3. 解锁：释放当前会话持有的所有锁，包括全局读锁。数据库恢复正常读写状态，被阻塞的写操作可以继续执行。
		- 手动释放：
			```
			UNLOCK TABLES;
			```
		- 超时释放：如果备份时间过长，可能导致连接超时，锁自动释放
    