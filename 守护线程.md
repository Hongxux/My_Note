---
aliases:
  - Daemon
---
|特性|用户线程 (User Thread)|守护线程 (Daemon Thread)|
|---|---|---|
|**生命周期与JVM**​|**JVM不会等待用户线程结束**。只要有一个用户线程在运行，JVM就不会退出。|**JVM不等待守护线程**。当所有用户线程都执行完毕时，JVM会立即退出，并终止所有正在运行的守护线程。|
|**用途**​|用于执行**核心业务逻辑**，需要完成的重要任务。|用于执行**辅助性、服务性的后台任务**，如监控、清理缓存等。|
|**默认类型**​|新创建的线程**默认是用户线程**。|需要通过 `setDaemon(true)`**显式设置**。|
|**优先级**​|通常具有较高的优先级。|通常具有较低的优先级。|
1. **不可用于关键任务**：由于守护线程可能在任何时候被JVM强制终止，**绝对不要**用它来执行需要保证完整性和一致性的任务，例如写入重要文件、提交数据库事务等，否则可能导致数据丢失或损坏。
    
2. **谨慎释放资源**：守护线程最好设计成能够响应中断信号，并在终止前尽可能地释放占用的资源（如文件句柄、网络连接）。
    
3. **理解生命周期的不可预测性**：守护线程中的 `finally`代码块不一定会被执行，因此不能依赖它来完成必要的清理工作。
4. **`setDaemon(true)`必须在调用 `start()`方法启动线程之前执行**。如果你在线程启动之后尝试设置，JVM将会抛出 `IllegalThreadStateException`异常
    

