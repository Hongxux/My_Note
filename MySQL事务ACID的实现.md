ACID特性的实现是数据库管理系统的核心。简单来说，​**Undo Log用于回滚以保障原子性，Redo Log用于崩溃恢复以保障持久性，锁和MVCC共同协调并发以保障隔离性，而所有这些机制，加上应用层的正确逻辑，共同确保了数据库的最终一致性。​**

![[Pasted image 20251102162346.png]]

| ACID 特性                  | 含义                                                | 核心实现机制概览                                                                     |
| ------------------------ | ------------------------------------------------- | ---------------------------------------------------------------------------- |
| ​**原子性 (Atomicity)​**​   | 事务中的所有操作是一个不可分割的整体，​**要么全部成功，要么全部撤销**。            | 主要依靠 ​**Undo Log**。记录数据修改前的镜像，用于事务回滚时撤销所有操作<br><br>。                         |
| ​**一致性 (Consistency)​**​ | 事务的执行必须使数据库从**一个正确的状态**变化到**另一个正确的状态**，遵循所有预设的规则。 | 由应用层和数据库**共同保证**。数据库通过约束（主键、外键等）校验，应用层确保业务逻辑正确<br><br>。                      |
| ​**隔离性 (Isolation)​**​   | 多个事务并发执行时，​**彼此互不干扰**，如同只有该事务在单独运行。               | [[隔离性的实现]]主要依赖 ​**MVCC（解决读写冲突） + 行级锁（解决写写冲突）​**​。MVCC通过创建数据快照来避免读写操作相互阻塞<br> |
| ​**持久性 (Durability)​**​  | 事务一旦成功提交，其对数据的修改就是**永久性的**，即使系统发生故障也不会丢失。         | 主要依靠 ​**Redo Log**。事务提交前先将数据变更写入重做日志，即使系统崩溃也能通过日志恢复数据<br><br>。               |


 **深入理解实现原理**

- ​**原子性的守护者：Undo Log**​
    
    你可以将Undo Log理解为数据库的"后悔药"。在修改任何数据前，系统都会先将数据修改前的状态（前镜像）记录到Undo Log中。如果事务执行失败或主动回滚，数据库引擎就会查阅Undo Log，执行反向操作，将数据恢复到事务开始前的状态，从而实现"全部成功"或"全部失败"的原子性承诺
    
    。
    
- ​**持久性的保障：Redo Log与WAL机制**​
    
    持久性通过**预写式日志**​ 技术实现。它的核心原则是：在数据页的变更**刷入磁盘之前**，必须先将变更内容**完整地写入Redo Log**并进行持久化。这样做的好处是，即使事务提交后数据库突然崩溃，内存中的数据丢失，在重启后也能通过重新执行Redo Log中记录的操作，将数据库恢复到崩溃前的状态，确保已提交事务的更改不会丢失
    
    。由于Redo Log是顺序写入的，这比随机写入数据页要高效得多。
    
- ​**隔离性的实现：锁与MVCC**​
    
    数据库通过多种手段协同实现隔离性：
    
    - ​**锁机制**​：这是最直观的方法，类似于"锁门"。当某个事务要修改数据时，会先获取锁（如排他锁），其他事务必须等待该锁被释放后才能操作，从而避免冲突
        
        。
        
    - ​**多版本并发控制 (MVCC)​**​：这是一种更高效的方式，可以理解为"生成快照"。MVCC允许数据库保留数据项的多个历史版本。当一个事务开始时，它会看到数据库在某个时间点的一致性快照。即使其他事务随后修改并提交了数据，当前事务读取的仍然是它开始时那个版本的数据，从而有效避免了不可重复读和脏读等问题，大大提升了并发性能
        
        。
        
    
- ​**一致性的共同责任**​
    
    一致性是应用的最终目标，而原子性、隔离性和持久性都是实现这一目标的手段
    
    。数据库本身通过**约束**​（唯一约束、外键约束、检查约束等）来强制数据符合预定义的规则，任何违反约束的操作都会中止
    
    。同时，​**应用层也负有重要责任**，需要编写正确的业务逻辑来确保数据从一个有效状态转变为另一个有效状态。
    

