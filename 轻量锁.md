- **常见场景**：适用于多个线程**交替执行**同步块，很多线程访问的实现错开，不存在竞态条件
    
- **实现流程**：
	1. 创建锁记录
		- 时机：线程在执行到synchronized时候
		- 实现方式：JVM 会在线程的栈帧中创建一个名为锁记录的空间，
			- 锁对象的引用地址
			- MarkWork数据块：
				- 初始：30位的锁记录的地址和2位的轻量锁标识
					- 用于和锁对象的MarkWork进行交换
				- 交换后：锁对象normal状态下的Mark Word
	2. 尝试使用 **CAS 操作**将对象头的Mark Word 与锁记录的MarkWork数据块进行交换![[Pasted image 20251130220432.png]]
		- 如果交换成功（Mark Word的状态标识为00），当前线程获得锁；![[Pasted image 20251130221015.png]]
		- 如果交换失败，失败的情况：
			- 其它线程持有了该 Object 的轻量级锁：这时表明有竞争，进入自旋（循环尝试获取）
			- 锁重入：再添加一条 Lock Record 作为重入的计数![[Pasted image 20251130221236.png]]
	3. 解锁（退出synchronized块）：
		- 如果有取值为null的锁记录：将这个锁记录清除
			- 代表有重入锁
		- 如果取值不为null的所记录：使用cas方式将Mark Word的值恢复给对象头
			- 成功，则解锁成功
			- 失败，则说明轻量级锁进行了[[锁膨胀]]或已经升级为重量级锁，进入重量级锁解锁流程
- [[自旋优化]]：

- （[[锁膨胀]]）：