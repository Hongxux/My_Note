### ⚙️ 核心前提：非负权边

Dijkstra 算法要求图中所有边的权重均为**非负值**​（`weight >= 0`）。这是整个证明成立的基石

。

### 🧠 推理与证明（反证法）

我们可以通过**反证法**来证明这个结论。

1. 1.
    
    ​**假设不成立**​：假设在节点 `u`从 PQ 中移除的时刻，我们声称的 `dist[u]`是源点 `s`到 `u`的最短路径长度**并不是真正的全局最短**。换言之，存在另一条从 `s`到 `u`的路径，其长度小于当前 `dist[u]`。
    
2. 2.
    
    ​**分析假设的路径**​：这条更短的路径必然没有完全被我们的算法处理完毕（否则 `dist[u]`就会被更新为更小的值了）。设在这条更短路径上，第一个**尚未被算法处理（即还未从 PQ 中移除）​**​ 的节点为 `x`，而 `y`是 `x`的前一个节点（`y`可能已经被处理，也可能 `x`就是起点 `s`）。
    
    则有：`s ~> y -> x ~> u`（`~>`表示路径，`->`表示边）。根据我们的假设，这条路径的总长度 < `dist[u]`。
    
3. 3.
    
    ​**推导矛盾**​：
    
    - •
        
        设 `s`到 `y`的路径长度为 `L(s, y)`，`y`到 `x`的边长为 `w(y, x)`，`x`到 `u`的路径长度为 `L(x, u)`。
        
    - •
        
        整条路径长度：`L(s, y) + w(y, x) + L(x, u) < dist[u]`。
        
    - •
        
        因为边权非负 (`w(y, x) >= 0, L(x, u) >= 0`)，所以必有：
        
        `L(s, y) + w(y, x) <= L(s, y) + w(y, x) + L(x, u) < dist[u]`​**​(式 1)​**​
        
        这个式子的左边 `L(s, y) + w(y, x)`正是从 `s`到 `x`的这条路径的长度。
        
    - •
        
        在节点 `y`被处理（从 PQ 中移除）时，我们一定已经松弛过边 `(y, x)`，所以 `dist[x]`的值最多为 `L(s, y) + w(y, x)`（可能更小，如果通过其他路径到 `x`更短）。即：
        
        `dist[x] <= L(s, y) + w(y, x)`​**​(式 2)​**​
        
    - •
        
        结合 ​**​(式 1)​**​ 和 ​**​(式 2)​**，我们得到：
        
        `dist[x] <= L(s, y) + w(y, x) < dist[u]`
        
        即 `dist[x] < dist[u]`。
        
    
4. 4.
    
    ​**得出结论**​：
    
    - •
        
        我们发现 `dist[x] < dist[u]`。而算法总是从 PQ 中取出当前 `dist`值最小的节点进行处理。
        
    - •
        
        既然 `dist[x] < dist[u]`，说明节点 `x`应该比节点 `u`​**更早**地从 PQ 中被取出和处理。
        
    - •
        
        但这与我们在第2步中的定义矛盾（我们定义 `x`是这条假设路径上**第一个未被处理**的节点）！
        
    - •
        
        因此，我们最初的假设（存在一条比 `dist[u]`更短的路径）是**错误**的。
        
    

​**故而得证**​：当节点 `u`从 PQ 中移除时，`dist[u]`就是 `s`到 `u`的最短路径长度。