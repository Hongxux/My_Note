---
aliases:
  - RequestEntity
  - ResponseEntity
---
RequestEntity å’Œ ResponseEntity æ˜¯ Spring æ¡†æ¶ä¸­ä¸¤ä¸ªéå¸¸å®ç”¨çš„ç±»ï¼Œå®ƒä»¬åˆ†åˆ«ç”¨äºåœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸­ç²¾ç»†åœ°å¤„ç† HTTP è¯·æ±‚å’Œæ„å»º HTTP å“åº”ã€‚ä¸‹é¢çš„è¡¨æ ¼èƒ½è®©ä½ å¿«é€ŸæŠ“ä½å®ƒä»¬çš„æ ¸å¿ƒæ¦‚å¿µå’ŒåŒºåˆ«ã€‚

|ç‰¹æ€§ç»´åº¦|RequestEntity|ResponseEntity|
|---|---|---|
|**æ ¸å¿ƒå®šä½**|å°è£…**ä¼ å…¥çš„**HTTPè¯·æ±‚|æ„å»º**è¿”å›çš„**HTTPå“åº”|
|**åŒ…å«å†…å®¹**|**è¯·æ±‚ä½“**(Body), **è¯·æ±‚å¤´**(Headers), **è¯·æ±‚æ–¹æ³•**(Method) å’Œ **è¯·æ±‚URL**(URL)|**å“åº”ä½“**(Body), **å“åº”å¤´**(Headers), **HTTPçŠ¶æ€ç **(Status Code)|
|**ä¸»è¦ç”¨é€”**|åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸­**è·å–**å®Œæ•´çš„è¯·æ±‚ä¿¡æ¯|åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸­**æ„å»º**å®Œæ•´çš„ã€å¯å®šåˆ¶çš„å“åº”|
|**å…¸å‹ä½¿ç”¨åœºæ™¯**|éœ€è¦è¯»å–è¯·æ±‚å¤´ã€è¯·æ±‚æ–¹æ³•æˆ–å®Œæ•´URLæ—¶|1. éœ€æŒ‡å®šç‰¹å®šHTTPçŠ¶æ€ç ï¼ˆéé»˜è®¤200ï¼‰  <br>2. éœ€æ·»åŠ è‡ªå®šä¹‰å“åº”å¤´  <br>3. **æ–‡ä»¶ä¸‹è½½**ç­‰ç‰¹æ®Šå“åº”|
|**åœ¨æ–¹æ³•ä¸­çš„ä½ç½®**|é€šå¸¸ä½œä¸ºæ§åˆ¶å™¨æ–¹æ³•çš„**å‚æ•°**|é€šå¸¸ä½œä¸ºæ§åˆ¶å™¨æ–¹æ³•çš„**è¿”å›å€¼**ç±»å‹|

### ğŸ’¡ æ ¸å¿ƒåº”ç”¨åœºæ™¯ä¸ä»£ç ç¤ºä¾‹

#### 1. RequestEntityï¼šæ·±å…¥æ´å¯Ÿè¯·æ±‚ç»†èŠ‚

å½“ä½ çš„æ§åˆ¶å™¨æ–¹æ³•éœ€è¦è®¿é—®**è¶…å‡ºè¯·æ±‚ä½“æœ¬èº«çš„ä¿¡æ¯**æ—¶ï¼Œä½¿ç”¨ `RequestEntity`å°±éå¸¸åˆé€‚ã€‚

- **è·å–è¯·æ±‚å¤´å’ŒURL**ï¼šä¾‹å¦‚ï¼Œä½ éœ€è¦éªŒè¯ä¸€ä¸ªç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆå¦‚ `Authorization`ä»¤ç‰Œï¼‰ï¼Œæˆ–è€…è®°å½•è¯·æ±‚çš„æ¥æºURLã€‚
    
    ```
    @PostMapping("/inspect")
    public String inspectRequest(RequestEntity<String> request) {
        HttpHeaders headers = request.getHeaders(); // è·å–æ‰€æœ‰è¯·æ±‚å¤´
        HttpMethod method = request.getMethod(); // è·å–è¯·æ±‚æ–¹æ³• (GET, POSTç­‰)
        URI url = request.getUrl(); // è·å–è¯·æ±‚çš„å®Œæ•´URL
        String body = request.getBody(); // è·å–è¯·æ±‚ä½“å†…å®¹
    
        // å¯ä»¥æ ¹æ®è¿™äº›ä¿¡æ¯è¿›è¡Œé€»è¾‘å¤„ç†...
        return "Request inspected";
    }
    ```
    

#### 2. ResponseEntityï¼šæ„å»ºç²¾ç»†åŒ–çš„å“åº”

`ResponseEntity`çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒè®©ä½ å¯¹å“åº”çš„æ§åˆ¶è¾¾åˆ°äº†æè‡´ã€‚

- **è‡ªå®šä¹‰çŠ¶æ€ç å’Œå“åº”å¤´**ï¼šåœ¨RESTful APIå¼€å‘ä¸­ï¼Œå‡†ç¡®çš„çŠ¶æ€ç è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºèµ„æºåè¿”å› `201 CREATED`å¹¶é™„ä¸Šæ–°èµ„æºçš„é“¾æ¥ã€‚
    
    ```
    @PostMapping("/users")
    public ResponseEntity<User> createUser(@RequestBody User user) {
        User savedUser = userService.save(user);
    
        // è®¾ç½®Locationå¤´ï¼ŒæŒ‡å‘æ–°åˆ›å»ºçš„èµ„æº
        URI location = ServletUriComponentsBuilder.fromCurrentRequest()
                .path("/{id}")
                .buildAndExpand(savedUser.getId())
                .toUri();
    
        // è¿”å›201çŠ¶æ€ç ã€è‡ªå®šä¹‰çš„Locationå¤´ä»¥åŠä¿å­˜çš„ç”¨æˆ·å¯¹è±¡
        return ResponseEntity.created(location).body(savedUser);
    }
    ```

- **æ„å»º Location å¤´ URI**
    
    - è¿™éƒ¨åˆ†ä»£ç ç”¨äºæ„å»º **HTTP Location å“åº”å¤´**ã€‚
        
    - `ServletUriComponentsBuilder.fromCurrentRequest()`ï¼šä»å½“å‰è¯·æ±‚ï¼ˆå³ `/users`ï¼‰æ„å»ºä¸€ä¸ª URI ç»„ä»¶ã€‚
        
    - `.path("/{id}")`ï¼šåœ¨å½“å‰è¯·æ±‚è·¯å¾„åè¿½åŠ ä¸€ä¸ªè·¯å¾„å˜é‡ `/{id}`ã€‚æœ€ç»ˆå½¢æˆçš„è·¯å¾„æ¨¡æ¿ç±»ä¼¼äº `/users/{id}`ã€‚
        
    - `.buildAndExpand(savedUser.getId())`ï¼šå°†è·¯å¾„å˜é‡ `{id}`æ›¿æ¢ä¸ºåˆšä¿å­˜çš„ç”¨æˆ·å¯¹è±¡çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆ`savedUser.getId()`ï¼‰ã€‚å‡è®¾æ–°ç”¨æˆ·çš„ ID æ˜¯ 123ï¼Œé‚£ä¹ˆæ„å»ºå‡ºçš„ URI å°±æ˜¯ï¼š`http://ä½ çš„åŸŸå/users/123`ã€‚
        
    - è¿™ä¸ª URI çš„æ„ä¹‰åœ¨äºï¼š**å®ƒè¡¨ç¤ºæ–°åˆ›å»ºçš„èµ„æºï¼ˆç”¨æˆ·ï¼‰çš„å”¯ä¸€è®¿é—®åœ°å€**ã€‚
        
    
- **`return ResponseEntity.created(location).body(savedUser);`**
    
    - è¿™è¡Œä»£ç æ„å»ºå¹¶è¿”å›æœ€ç»ˆçš„ HTTP å“åº”ã€‚
        
    - `ResponseEntity.created(location)`ï¼šè¿™æ˜¯ä¸€ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªçŠ¶æ€ç ä¸º **`201 Created`**çš„å“åº”æ„å»ºå™¨ã€‚HTTP 201 çŠ¶æ€ç ä¸“é—¨ç”¨äºè¡¨ç¤ºå›  POST è¯·æ±‚è€ŒæˆåŠŸåˆ›å»ºäº†æ–°èµ„æºã€‚åŒæ—¶ï¼Œå®ƒå°†ä¸Šé¢æ„å»ºå¥½çš„ URI è®¾ç½®åˆ°å“åº”çš„ **`Location`**å¤´ä¸­ã€‚
        
    - `.body(savedUser)`ï¼šå°†ä¿å­˜å¥½çš„ `savedUser`å¯¹è±¡ä½œä¸ºå“åº”ä½“è¿”å›ç»™å®¢æˆ·ç«¯ã€‚Spring ä¼šè‡ªåŠ¨å°†å®ƒè½¬æ¢ä¸º JSON æ ¼å¼ã€‚
        
    - æœ€ç»ˆï¼Œå®¢æˆ·ç«¯ä¼šæ”¶åˆ°ä¸€ä¸ªçŠ¶æ€ç ä¸º 201 çš„å“åº”ï¼Œå“åº”å¤´ä¸­åŒ…å« `Location: http://ä½ çš„åŸŸå/users/123`ï¼Œå“åº”ä½“åˆ™æ˜¯æ–°ç”¨æˆ·å®Œæ•´çš„ JSON æ•°æ®ã€‚


- **å®ç°æ–‡ä»¶ä¸‹è½½**ï¼šè¿™æ˜¯ `ResponseEntity`çš„ä¸€ä¸ªç»å…¸åº”ç”¨åœºæ™¯ã€‚ä½ å¯ä»¥è®¾ç½®å†…å®¹ç±»å‹å’Œ `Content-Disposition`å¤´ï¼Œè®©æµè§ˆå™¨ä»¥ä¸‹è½½æ–¹å¼å¤„ç†å“åº”ã€‚
    
    ```
    @GetMapping("/download")
    public ResponseEntity<byte[]> downloadFile() throws IOException {
        // ä»æŸå¤„ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ï¼‰è¯»å–æ–‡ä»¶æ•°æ®åˆ°å­—èŠ‚æ•°ç»„
        byte[] fileData = ...;
    
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);
        headers.setContentDispositionFormData("attachment", "filename.txt"); // å…³é”®ï¼šè§¦å‘ä¸‹è½½
    
        // è¿”å›æ–‡ä»¶æ•°æ®ã€å“åº”å¤´å’Œ200çŠ¶æ€ç 
        return new ResponseEntity<>(fileData, headers, HttpStatus.OK);
    }
    ```
    

### âš–ï¸ ä¸å…¶ä»–æ³¨è§£çš„å…³ç³»

- **ä¸ `@RequestBody`/ `@ResponseBody`çš„å…³ç³»**ï¼š`RequestEntity`å’Œ `ResponseEntity`å¯ä»¥çœ‹ä½œæ˜¯å®ƒä»¬çš„â€œå¢å¼ºç‰ˆâ€ã€‚`@RequestBody`åªå…³æ³¨è¯·æ±‚ä½“ï¼Œ`@ResponseBody`åªå…³æ³¨å“åº”ä½“ï¼Œè€Œ `RequestEntity`/`ResponseEntity`æä¾›äº†å¯¹å®Œæ•´HTTPæŠ¥æ–‡ï¼ˆå¤´ã€ä½“ã€çŠ¶æ€ç­‰ï¼‰çš„è®¿é—®å’Œæ§åˆ¶èƒ½åŠ› ã€‚
    
- **`@RestController`çš„é»˜è®¤è¡Œä¸º**ï¼šåœ¨æ ‡è®°äº† `@RestController`çš„ç±»ä¸­ï¼Œæ–¹æ³•çš„è¿”å›å€¼é»˜è®¤ä¼šè¢«å½“ä½œå“åº”ä½“ï¼Œç›¸å½“äºè‡ªåŠ¨æ·»åŠ äº† `@ResponseBody`ï¼Œå¹¶è¿”å›200çŠ¶æ€ç ã€‚å½“ä½ éœ€è¦æ‰“ç ´è¿™ä¸ªé»˜è®¤çº¦å®šï¼ˆå¦‚è¿”å›ä¸åŒçš„çŠ¶æ€ç æˆ–è®¾ç½®å“åº”å¤´ï¼‰æ—¶ï¼Œä½¿ç”¨ `ResponseEntity`å°±æ˜¯æœ€ä½³é€‰æ‹© ã€‚
    

### ğŸ“Œ æ€»ç»“ä¸å»ºè®®

ç®€å•æ¥è¯´ï¼Œ**RequestEntity å¸®ä½ â€œè¯»â€å¾—æ›´å…¨ï¼ŒResponseEntity è®©ä½ â€œå†™â€å¾—æ›´ç»†ã€‚**

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¦‚æœä½ çš„éœ€æ±‚å¾ˆç®€å•ï¼Œæ¯”å¦‚åªæ˜¯æ¥æ”¶ä¸€ä¸ªJSONè¯·æ±‚ä½“æˆ–è¿”å›ä¸€ä¸ª200çŠ¶æ€ç çš„JSONæ•°æ®ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨ `@RequestBody`å’Œ `@ResponseBody`ï¼ˆæˆ– `@RestController`ï¼‰ä¼šæ›´åŠ ç®€æ´ã€‚

ä½†æ˜¯ï¼Œå½“ä½ éœ€è¦å¯¹HTTPè¯·æ±‚å’Œå“åº”è¿›è¡Œ**æ›´ç²¾ç»†åŒ–çš„æ§åˆ¶**æ—¶ï¼Œ`RequestEntity`å’Œ `ResponseEntity`å°±æ˜¯ä½ å¾—åŠ›çš„å·¥å…·ã€‚

å¸Œæœ›è¿™ä¸ªè§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°ç†è§£è¿™ä¸¤ä¸ªé‡è¦çš„ç±»ï¼