## **一、 核心抽象：文件与目录**​

- ​**1.1 文件的抽象**​
    
    - ​**定义**​：文件是一个线性数组（或序列）的字节，每个字节都可以被读取或写入。它是存储虚拟化的基本抽象之一。
        
    - ​**低级名称**​：每个文件都有一个操作系统使用的低级标识符，通常是一个数字。这个低级名称在历史上常被称为 ​**inode号**。用户通常不直接感知此名称。
        
    - ​**文件内容**​：文件系统的主要职责是持久化存储数据，并在下次请求时准确返回数据，它通常不关心文件内容的具体结构（如文本、图片等）。
        
    
- ​**1.2 目录的抽象**​
    
    - ​**定义**​：目录**也是一种文件**，拥有自己的低级名称（inode号），但其内容具有特定结构：它是一个包含一系列（用户可读名称，低级名称）**映射对的列表**。
        
    - ​**功能**​：目录中的每个条目将用户可读的名称（如"foo"）映射到文件或目录的低级名称（如inode号"10"）。条目可以指向文件或其他目录。
        
    - ​**构建层次结构**​：通过将目录放置在其他目录之内，可以构建出任意深度的**目录树**​（或称目录层次结构）。
        
    

## ​**二、 目录树与命名系统**​

- ​**2.1 目录树的结构**​
    
    - ​**根目录**​：目录层次结构的起点。在类UNIX系统中，根目录被表示为 `/`。
        
    - ​**路径名**​：通过路径分隔符（如UNIX中的`/`）连接目录名，可以唯一指定一个文件或目录的位置。
        
        - ​**绝对路径名**​：从根目录开始的完整路径，例如 `/foo/bar.txt`。
            
        
    - ​**示例**​：一个复杂的目录树可能包含多个目录和文件，只要位于树中的不同位置，文件或目录可以重名（例如，`/foo/bar.txt`和 `/bar/foo/bar.txt`是两个不同的文件）。
        
    
- ​**2.2 命名的重要性与约定**​
    
    - ​**统一命名空间**​：文件系统提供了统一的命名方式，不仅是磁盘文件，还包括设备、管道等，都可通过目录树进行访问，这简化了系统概念模型，增强了模块化。
        
    - ​**文件命名约定**​：文件名常由两部分组成（如 `bar.txt`），第一部分是任意名称，第二部分（扩展名，如 `.txt`）通常用于指示文件类型（如 `.c`为C代码，`.jpg`为图片）。但这只是一种**约定**，文件系统本身并不强制或检查文件内容与扩展名是否匹配。
​​
## **三、 文件系统接口**
### **1. 文件操作详解**
本章深入探讨了对文件的核心操作：

-  **[[创建文件]]​** ：介绍了创建新文件的系统调用（如 `open`带有 `O_CREAT`标志）。
    
-  **​[[读写文件]]** ​：详细讲解了如何读取和写入文件内容，这是文件系统最基本的功能。
    
-  **[[非顺序读写]]** ：特别强调了通过 `lseek`等系统调用实现随机存取的能力，即可以在文件中任意位置进行读写。
    
- **​[[通过 `fsync()`立即写入]]** ：解释了如何确保数据真正写入磁盘，而非仅存在于操作系统缓存中，这对于需要强一致性保证的应用程序至关重要。
    
- **[[重命名文件]]** ：说明了重命名操作（如 `rename`系统调用）的原子性及其重要性。
    
-  **​[[获取文件信息]]** ：介绍了如何获取文件的元数据（如大小、创建时间、权限等），例如通过 `stat`系统调用。
    
- ​ **[[删除文件]]** ：讲解了文件删除的接口（如 `unlink`）及其实际含义。


###  **2. 目录操作详解**
随后，章节转向对目录的管理：

- ​**创建目录**​：如 `mkdir`系统调用。
    
- ​**读取目录**​：介绍了如何列出目录内容（如使用 `opendir`, `readdir`等）。
    
- ​**删除目录**​：如 `rmdir`系统调用，通常要求目录为空。
    

### 3. 链接概念
 
 
本章区分了两种重要的链接机制，这是理解文件系统树状结构的关键：

-  **[[硬链接]]** ​ ：解释了多个目录项指向同一个磁盘索引节点（inode）的机制及其限制。
    
- **​[[符号链接]]**（软链接）：介绍了作为一种特殊文件存在的快捷方式，其内容是被引用文件的路径。
    
### 4. 文件系统的制作与挂载
​​
- 最后，章节触及了文件系统如何被集成到操作系统中使用，即**制作文件系统**​（格式化）和**挂载**到一个现有目录树的具体位置，从而让用户能够访问其中的文件。