

​**核心主题：文件元数据与 Inode**​

​**一、 元数据的概念**​

1. ​**定义：​**​ 文件系统不仅存储文件内容（数据），还存储关于文件的描述性信息，这些信息被称为**元数据**。
    
2. ​**作用：​**​ 元数据记录了文件的各类属性，而非文件本身的内容。
    

​**二、 如何查看元数据**​

1. ​**系统调用：​**​
    
    - 通过 `stat()`或 `fstat()`系统调用可以获取指定文件的元数据。
        
    - `stat()`接受文件路径作为参数。
        
    - `fstat()`接受已打开文件的文件描述符作为参数。
        
    
2. ​**命令行工具：​**​
    
    - 使用 `stat`命令可以方便地在命令行中查看文件的完整元数据。
        
    - ​**示例：​**​
        
        ```
        prompt> echo hello > file  # 创建一个内容为"hello"的文件
        prompt> stat file          # 查看该文件的元数据
        ```
        
    

​**三、 元数据的具体内容（`struct stat`）​**​

系统调用会填充一个名为 `stat`的结构体，该结构体包含了文件的完整元数据信息，主要可分为以下几类：

1. ​**标识信息:​**​
    
    - `st_ino`(**inode number**): 文件的低级名称（在文件系统内的唯一标识符）。
        
    - `st_dev`: 文件所在设备的ID。
        
    
2. ​**类型与权限信息:​**​
    
    - `st_mode`: 文件类型（如普通文件、目录）和访问权限位。
        
    
3. ​**所有权信息:​**​
    
    - `st_uid`: 文件所有者的用户ID。
        
    - `st_gid`: 文件所属组的组ID。
        
    
4. ​**大小与存储空间信息:​**​
    
    - `st_size`: 文件的总大小（以字节为单位）。
        
    - `st_blocks`: 分配给文件的磁盘块数量。
        
    - `st_blksize`: 文件系统I/O操作的首选块大小。
        
    
5. ​**链接信息:​**​
    
    - `st_nlink`: 指向该文件的硬链接数量。
        
    
6. ​**时间戳信息:​**​
    
    - `st_atime`: 文件内容最后一次被**访问**的时间。
        
    - `st_mtime`: 文件内容最后一次被**修改**的时间。
        
    - `st_ctime`: 文件元数据（如权限、所有者）最后一次被**改变**的时间。
        
    
7. ​**特殊文件信息:​**​
    
    - `st_rdev`: 如果文件是设备文件，则包含该设备的ID。
        
    

​**四、 元数据的存储载体：Inode**​

1. ​**核心概念：​**​ 文件系统将每个文件的元数据存储在一个称为 ​**inode**​（索引节点）的数据结构中。
    
2. ​**角色：​**​ 可以将 inode 理解为一个**持久化的数据结构**，由文件系统维护，专门用于保存如上所述的各类文件元数据。
    
3. ​**重要性：​**​ inode 是文件系统实现的基础，通过 inode 号可以唯一地定位和访问一个文件及其所有属性。
    

​**总结逻辑层次:​**​

1. ​**是什么：​**​ 引入元数据的概念。
    
2. ​**怎么查：​**​ 介绍查看元数据的系统调用和实用工具。
    
3. ​**有什么：​**​ 详细分类和解释元数据所包含的具体信息项。
    
4. ​**存何处：​**​ 揭示元数据在文件系统底层是存储在名为 inode 的关键数据结构中的，为后续学习文件系统实现打下基础。