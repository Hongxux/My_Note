
---

### ​**一、磁盘调度的核心目标**​

- ​**问题根源**​：I/O成本极高（寻道+旋转延迟占95%以上时间）。
    
- ​**调度原则**​：遵循**SJF（最短作业优先）​**，优先服务耗时最少的I/O请求。
    

---

### ​**二、经典调度算法及局限性**​

1. ​**SSTF（最短寻道时间优先）​**​
    
    - ​**原理**​：优先服务与磁头当前位置**最近磁道**的请求。
        
    - ​**缺陷**​：
        
        - ​**饥饿问题**​：持续到来的邻近请求会阻塞远端请求（如磁头停留在内圈时，外圈请求无限延迟）。
            
        - ​**信息缺失**​：操作系统仅知逻辑块地址，无法直接获取物理磁道信息（需转换为**最近块优先NBF**）。
            
        
    
2. ​**电梯算法（SCAN/C-SCAN）​**​
    
    - ​**原理**​：磁头单向移动（如内→外），服务沿途请求，到端点后折返（SCAN）或直接复位（C-SCAN）。
        
    - ​**解决**​：避免饥饿，保证公平性。
        
    - ​**新问题**​：
        
        - 忽略旋转延迟，未真正实现SJF（例：请求A的寻道短但旋转长，请求B的寻道长但旋转短时，可能误选A）。
            
        - 响应时间不均（端点请求需等待全程扫描）。
            
        
    

---

### ​**三、优化方案：SPTF（最短定位时间优先）​**​

- ​**核心思想**​：同时考虑**寻道时间 + 旋转延迟**，综合选择定位时间最短的请求。
    
- ​**优势**​：更贴近SJF原则，显著减少I/O时间（尤其当旋转延迟与寻道时间相当时）。
    
- ​**挑战**​：
    
    - 操作系统无法精确感知磁头旋转位置及磁道边界。
        
    
- ​**现代实现**​：由**磁盘内部调度器**执行（控制器掌握磁头位置、磁道布局等细节）。
    

---

### ​**四、现代磁盘调度实践**​

1. ​**分层调度**​：
    
    - ​**OS层**​：合并相邻I/O请求（如读33、34块合并为单请求），预选一批请求（如16个）发给磁盘。
        
    - ​**磁盘层**​：内部调度器基于SPTF精细化排序请求。
        
    
2. ​**非工作保守调度**​：
    
    - 策略：收到请求后**短暂等待**​（约几毫秒），可能迎来更优请求（减少磁头移动）。
        
    - 风险：等待时间过长会降低响应速度，需权衡。
        
    

---

### ​**五、关键结论**​

1. ​**算法演进逻辑**​：
    
    SSTF（解决随机I/O低效）→ 电梯算法（解决饥饿）→ SPTF（综合寻道+旋转逼近最优）。
    
2. ​**工程哲学**​：
    
    - ​**​“It depends”​**​：最优选择取决于寻道/旋转时间比（例：请求16（中圈）vs 8（外圈）的选择需动态计算）。
        
    - ​**硬件协同**​：现代系统将复杂调度卸载至磁盘控制器，OS专注请求合并与预选。
        
    

---

​**总结**​：磁盘调度是权衡寻道、旋转延迟和公平性的艺术，现代方案通过OS/磁盘分层协作（OS合并请求+磁盘SPTF调度）最大化性能，同时规避了早期算法的饥饿与效率问题。