- 需求背景：集中式架构：中心节点负责与每个节点建立连接并进行数据同步
	- 这极易导致**中心节点自身**和网络连接成为**性能瓶颈**，消息分发的延迟会显著增加
	- 这种架构存在**单点故障**​ 风险
- 核心思想：让集群中的每个节点都参与到信息共享中来
	- 最终结果：所有节点都能获知整个集群的状态。
- 优势：
	- **去中心化与高容错**：没有单点故障，任何节点的加入、离开或宕机都不会导致整个集群的通信崩溃
	- **可扩展性**：在节点数量较多时，其扩散速度比中心化的广播方式更快。
	- **最终一致性**：尽管有延迟，但理论上所有节点的状态最终会达成一致、
- 问题：
	- **消息延迟**：信息需要经过多个轮次才能传播到所有节点，会出现短暂的状态不一致，即**最终一致性**
	- **消息冗余**：由于随机选择，同一个节点可能会多次收到相同的信息，造成一定的网络带宽浪费
---
- 通信基础：
	- 集群中的每个节点都会开辟一个独立的 **TCP 端口**（通常是客户端端口号 +10000）专用于节点间通信

- 消息格式：
	- 消息头​：节点自身的核心元数据，如节点ID、负责的哈希槽位、配置纪元
	- 消息体：要传播的具体信息
- 消息类型：
	- PING：节点**主动**向其他节点发送的消息，用于**交换**彼此的状态信息
	- PONG：
		- 发送方的目的：
			- 作为对 PING 或 MEET 消息的**响应**回复，同时也会**携带自身状态信息**
			- 新的主节点通过PONG主动**广播** ：**更新自身状态**。
	- MEET：一种特殊的 PING 消息，用于**请求让自己作为一个新节点加入集群**。
	- FAIL：当某个节点判定另一个节点客观下线时，会向集群**广播**此消息，通知其他节点将故障节点标记为下线状态。
		  
- 工作模式：**周期性的、随机的、对等的**信息交换
	- 目标：达成全局状态的一致
	- **周期性通信**：每个节点默认每秒会执行10次周期性任务（即每100毫秒一次）
	- **选择通信对象**：
		- 选择方式一：
			- 选择范围：已知的节点列表中随机选择的5个节点
			- 选择目标：最久没有通信的一个节点
		- 选择方式二：
			- 选择范围：所有已知的节点
			- 选择目标：最后一次成功通信的时间超过 `cluster-node-timeout`的一半（默认15秒，则超过7.5秒）
			- 目的：防止信息过期
		- 发送的消息类型：PING 消息
	- **信息交换与更新**：
		- 接受的消息类型： PING 或 MEET 消息
		- 消息内容：
			- 自身的状态（如是否存活、负载情况）
			- 其他节点的状态（来自其他节点的PING消息）
		- 消息同步：
			1. 解析消息头和自己本地的信息进行比对、更新
			2. 用 PONG 消息回复，附带自己的状态
		- 产出结果：一次通信周期就能使两个节点的状态达到完全一致