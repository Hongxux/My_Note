#### 机制说明
完成三次握手后，双方协议栈的套接字状态都会从"未连接"变为"已连接"。
本质：建立连接的信道检测与参数协商，​**非数据包传输行为**。
- ​**机制说明**​：
    
    TCP通过**三次握手（three-way handshaking）​**​ 建立连接，确保数据准确送达：
	    **传统方式：**
		    1. ​**SYN**​：客户端发送带`SYN`标志的报文（携带初始序列号`ISN_C`） →
		    2. ​**SYN/ACK**​：首先判断[[连接队列]]中的半连接队列是否没有满，若是没有满，则服务器返回`SYN+ACK`标志的报文（携带自身`ISN_S`并确认`ISN_C+1`） ，若是满了，则放弃连接 →
			3. ​**ACK**​：客户端回传`ACK`标志报文完成连接（确认`ISN_S+1`）。
				1. ​**Client → Server**: `[SYN] Seq = 1000`
			    -（客户端：我想连接，我的序号从1000开始。）
				2. ​**Server → Client**: `[SYN, ACK] Seq = 5000, Ack = 1001`
		        -（服务器：我同意连接。我的序号从5000开始，确认收到你的1000号包。）
				3. ​**Client → Server**: `[ACK] Ack = 5001`
			    -  （客户端：确认收到你的5000号包。)
	    **[[SYN Cookie#^ca49e4|SYN Cookies开启后]]：**
[[ISN_C和ISN_S的区别]]
SYN标志位在握手阶段携带**初始序列号（ISN）​**，用于确定首数据包的序列号
	（例如：ISN_C = 1000 则首数据包`SEQ=ISN_C+1 = 1000+1 = 1001`）
	**[[数据序列号（Sequence Number）]]​**​ 是TCP协议实现可靠传输的核心机制，其本质是**为每个传输的字节分配唯一编号，解决数据包乱序、丢包和重复问题** ^163f1e
- 声明数据包的起始编号（如`ISN=1000`，则首个数据包序列号为1001）。
- 确保传输双方按顺序重组数据（防止乱序）。

- ​**目的**​：
    
    验证通信双方收发能力正常，为后续数据传输提供可靠性保障（同步数据传输的初始序列号）。


#### **功能实现细节**​

##### 1. ​**数据分割流程**​


- 应用层数据（如HTTP请求）→ TCP层分割为多个报文段 → 添加序号和端口号 → 交予IP层封装传输。
    
- 接收端按序号重组数据，确保顺序正确。
    

##### 2. ​**三次握手可靠性保障**​

- ​**握手失败处理**​：若某阶段中断，TCP会重发相同数据包（序列号不变），直至收到确认响应。
    
- ​**补充机制**​：除握手外，TCP还通过**序列号确认**、**超时重传**、**流量控制**等确保端到端可靠性（1.4.2节）。
    
