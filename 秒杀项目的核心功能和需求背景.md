### 用户背景和业务场景
1. 核心业务场景：
	- 秒杀本质是限时、限量、低价的促销活动
	- 首要目的是为平台引流、提升销量和品牌影响力
2. 用户行为特征
	- 瞬时高峰：活动开始瞬间，数百万用户可能同时点击，产生极高的并发请求
		- 例如，300万用户每人请求3次，在10秒内完成，瞬时TPS可达90万/秒
	- 读多写少：绝大部分请求是查询商品信息、库存状态等读操作（可能占70%以上），真正下单成功的写操作占比较小
	- 体验要求高：用户期望响应迅速、流程顺畅，抢购结果反馈要及时明确
### 具体挑战

1. 正确性：数据一致性
	- 实现的目标
		- 不会超卖
		- 不会少卖
	- 扣减时机的选择
		- “下单减库存”体验更好，但需要处理恶意下单不付款的情况，通常需要引入支付超时释放库存（回仓​ 的机制
			- 这意味着系统需要有能力处理订单超时后，异步恢复库存并通知可能正在等待的用户。
	- 事务回滚的完备性：异步处理链路中（如：Redis预扣减 -> 消息队列 -> 数据库最终落地），任何一个环节失败都需要有严密的**补偿机制**。
2. 公平性
	- 规则公平性：
		- 一人一单
		- 先到先得
	- 构建防作弊体系
3. 高性能：高吞吐量，低延迟，高并发，
	- 大量的读取,并发压力高：[[4要1不要原则]]
		- 构建“漏斗型”流量管控体系
		- 热点数据的动态实时发现与隔离
		- 动静分离的详细落地方案
		- 代码层面的极致优化（如减少序列化）
	- 秒杀的下单
4. 高可用:某个服务器、数据库、Redis崩溃，不会影响秒杀活动的进行
	- 预防：
		- **服务降级与熔断（柔性可用）**：明确系统的核心功能（如下单、支付）和非核心功能（如积分抵扣、商品推荐）。当系统压力过大或某些依赖服务不稳定时，可以**暂时关闭非核心功能（降级）**，或快速失败防止雪崩（熔断），确保核心链路畅通
		- **过载保护与弹性伸缩**：设定系统负载阈值，在达到临界点时主动拒绝部分请求，保护系统不被打垮。同时，在云环境下，可配置规则让系统在流量高峰时自动增加实例（扩容），低谷时减少实例（缩容）。
		- **隔离策略**：正如你所虑，需从不同层面进行隔离：
		    - **业务隔离**：将秒杀系统与主站常规业务系统在逻辑上分离。
		    - **系统隔离**：将秒杀系统部署在独立的服务器集群上，甚至使用独立域名，避免秒杀流量影响正常业务
		    - **数据隔离**：为秒杀业务使用独立的缓存集群和数据库实例
	- 监控和追踪：
		- 全链路监控（如使用Prometheus监控QPS、响应时间）
		- 全链路追踪（如使用SkyWalking）体系
### 核心功能
1. **秒杀活动管理**：供运营人员创建、配置和管理秒杀活动，包括设置商品、秒杀价、库存、活动时间等
2. **库存管理**：这是秒杀系统的生命线。核心是**库存预热**（活动开始前将库存从数据库加载到Redis）和**原子扣减**（在Redis中通过Lua脚本等原子操作完成扣减，防止超卖）
3. **订单处理**：采用**异步下单**流程。用户秒杀请求通过校验后，系统快速返回“排队中”等状态，然后将订单信息发送到消息队列，由后台服务异步消费并生成数据库订单。这实现了**削峰填谷**。
4. **限流与防刷**：
    - **限流**：在网关层（如Nginx）和应用层设置限流规则，例如使用令牌桶算法
        ，控制单位时间内的请求数量。
    - **防刷**：可能包括前端按钮防重复点击、验证码、对用户ID或IP进行频次控制等措施