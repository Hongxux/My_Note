---
aliases:
  - Daemon
---
- 需求背景：不得不手动终止驻留线程
	- 有的线程需要驻留，时时刻刻提供服务：while（ture）
	- JVM进程退出需要所有的用户线程执行完毕
		- 这个驻留的线程会阻碍JVM进程退出
		- 你不得不手动干预解决
- 解决方法：将这个线程设置为守护线程
	- JVM判断只剩下守护线程运行时，就没有继续运行的必要了，会主动退出


1. **不可用于关键任务**：由于守护线程可能在任何时候被JVM强制终止，**绝对不要**用它来执行需要保证完整性和一致性的任务，例如写入重要文件、提交数据库事务等，否则可能导致数据丢失或损坏。
    
2. **谨慎释放资源**：守护线程最好设计成能够响应中断信号，并在终止前尽可能地释放占用的资源（如文件句柄、网络连接）。
    
3. **理解生命周期的不可预测性**：守护线程中的 `finally`代码块不一定会被执行，因此不能依赖它来完成必要的清理工作。
4. **`setDaemon(true)`必须在调用 `start()`方法启动线程之前执行**。如果你在线程启动之后尝试设置，JVM将会抛出 `IllegalThreadStateException`异常
    

