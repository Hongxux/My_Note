

### ​**UNION 操作符详解**​

​**作用**​：将多个 SELECT 查询的结果集合并成一个结果集，便于数据整合分析。

---

#### ​**基本语法**​

```
SELECT 字段列表 FROM 表A ...
UNION [ALL]
SELECT 字段列表 FROM 表B ...;
```

- ​**`UNION`**​：合并后自动去重（删除重复行）
    
- ​**`UNION ALL`**​：直接合并所有数据，保留重复记录
    

---

#### ​**关键规则（强制要求）​**​

1. ​**列数一致**​：所有 SELECT 语句的列数必须相同
    
2. ​**数据类型兼容**​：对应列的数据类型必须一致或可隐式转换
    
    （如：`INT`与 `DECIMAL`兼容，但 `VARCHAR`与 `DATE`不兼容）
    

---

#### ​**使用场景示例**​

1. ​**合并不同表的相同结构数据**​
    
    ```
    -- 合并员工和经理的联系方式
    SELECT name, phone FROM employees
    UNION
    SELECT name, phone FROM managers;
    ```
    
2. ​**分条件统计同一张表的数据**​
    
    ```
    -- 统计不同状态的订单数量（去重）
    SELECT status, COUNT(*) FROM orders WHERE amount > 100
    UNION
    SELECT status, COUNT(*) FROM orders WHERE amount <= 100;
    ```
    
3. ​**`UNION ALL`用于需要保留重复值的场景**​
    
    ```
    -- 合并日志记录（需保留重复条目）
    SELECT user_id, action FROM log_2023
    UNION ALL
    SELECT user_id, action FROM log_2024;
    ```
    

---

#### ​**性能与注意事项**​

- ​**去重成本**​：`UNION`需排序去重，比 `UNION ALL`耗时，大数据量时优先用 `UNION ALL`
    
- ​**字段对齐**​：可通过 `NULL AS placeholder`补全缺失字段
    
- ​**排序限制**​：ORDER BY 子句只能放在最后一条 SELECT 语句后
    

此操作符是数据报表和跨查询分析的常用工具，需严格遵循列匹配规则。