

热部署的核心目的是**提升开发效率**。它允许你在修改代码后，无需手动重启整个应用，就能立即看到变化生效。

### 1. 热部署的原理与范围
热部署只进行重启，不进行重载
热部署的工作机制基于两种类加载器：

- **重启（Restart）**：
    
    - **作用范围**：你**自定义开发的代码**，例如 Java类、页面模板（HTML）、配置文件等。
        
    - **加载器**：由 `restart`类加载器负责。**这是热部署主要管理的部分。**
        
    
- **重载（Reload / Relaunch）**：
    
    - **作用范围**：项目所依赖的第三方 `jar`包。
        
    - **加载器**：由 `base`类加载器负责。**热部署功能通常不会重新加载这些内容**，如果需要更新jar包，一般需要完全重启应用。
        
    

**简单来说**：热部署主要服务于你正在编写的业务代码，而不涉及外部依赖库。

### 2. 配置热部署
#### 启用热部署
启用热部署非常简单，只需一步：

**在项目的 `pom.xml`文件中添加 `spring-boot-devtools`依赖。**

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-devtools</artifactId>
    <optional>true</optional>
</dependency>
```

- **注意点**：`<optional>true</optional>`这个配置很重要，它可以防止将 `devtools`依赖传递到其他模块中，避免在生产环境被意外使用。
#### 配置热部署范围

##### 1.默认不触发热部署的范围
Spring Boot DevTools 为了提升效率，**默认排除（即不监控）** 对某些目录下文件的修改。这意味着当你修改这些目录里的文件时，应用**不会自动重启**。

**这些目录主要是存放静态资源的路径：**

- `/META-INF/maven`
    
- `/META-INF/resources`
    
- `/resources`
    
- `/static`
    
- `/public`
    
- `/templates`
    

**为什么这么设计？**

因为这些目录通常用来存放前端资源，如 `.css`、`.js`、图片、HTML 文件等。浏览器可以直接请求这些资源，无需经过 Spring Boot 的后端处理逻辑。因此，修改它们之后，你通常只需要刷新浏览器页面即可看到变化，完全没必要重启整个后端 Java 应用，从而**节省了大量等待重启的时间**。
##### 2. 自定义配置：覆盖默认排除项

如果你希望**进一步扩展**不触发重启的目录列表，可以在 `application.yml`配置文件中进行自定义。

**配置示例：**

```
devtools:
  restart:
    exclude: public/**,static/**
```

- **作用**：这行配置**在默认排除列表的基础上，额外添加了 `public/`和 `static/`目录**。实际上，由于这两个目录已经在默认排除列表中，这个示例更像是一个演示。它的意义在于，你可以通过这种方式排除任何你自定义的路径。
    
- **语法**：使用通配符 `**`来表示该目录及其所有子目录。

#### 关闭热部署
为了避免多个配置文件冲突，选择在更高级处配置热部署的关闭
```
@SpringBootApplication
public class Springboot09DevtoolsApplication {
    public static void main(String[] args) {
        // 在应用启动前，设置系统属性来禁用热部署
        System.setProperty("spring.devtools.restart.enabled", "false");
        // 启动Spring应用
        SpringApplication.run(Springboot09DevtoolsApplication.class, args);
    }
}
```

**关键点解读：**

1. **禁用原理**：代码通过 `System.setProperty`方法，设置了一个名为 `spring.devtools.restart.enabled`的系统属性，并将其值设为 `false`。这个属性直接控制了热部署功能的开关。
    
2. **“高优先级”的含义**：在 Spring Boot 中，系统属性（System Properties）的优先级通常高于配置文件（如 `application.yml`）中的设置。这意味着，即使你在 `application.yml`里配置了 `spring.devtools.restart.enabled: true`（启用），这行代码也会覆盖掉配置文件的设置，最终导致热部署被禁用。这是一种**强制禁用**的手段。
    
3. **执行时机**：这行代码被放在 `main`方法的最开始，在 `SpringApplication.run()`之前执行。这确保了在 Spring 容器初始化之前，禁用指令就已经生效。


### 3. 如何触发热部署（重新构建项目）

配置好依赖后，当你修改了代码，需要通过以下两种方式**触发**热部署：

- **手动**重新构建项目：使用快捷键`Ctrl + F9`（在 Windows/Linux 的 IDEA 中）
	- 这个快捷键对应于 IDEA 中的 **“构建项目”** 操作。热部署功能会监听到项目重新构建的事件，然后自动执行“重启”过程。
- **自动**重新构建项目
	1. 
	![[Pasted image 20251112144534.png]]
	2. 
	alt+ctrl+shift+/激活下面的菜单
	![[Pasted image 20251112144624.png]] 
	3. 激活方式：Idea失去焦点5秒后自动构建项目








