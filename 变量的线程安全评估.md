- 成员变量和静态变量是否线程安全?
	- 如果它们没有共享，则线程安全
	- 如果它们被共享了，根据它们的状态是否能够改变，又分两种情况
		- 如果只有读操作，则线程安全
		- 如果有读写操作，则这段代码是临界区，需要考虑线程安全![[Pasted image 20251130202048.png]]
- 局部变量是否线程安全
	- 局部变量是线程安全的：局部变量在线程之间是不共享的![[Pasted image 20251130201047.png]]![[Pasted image 20251130202137.png]]
		- 原因：每个线程的栈帧的局部变量表是相互独立，互不干扰的
	- 但局部变量引用的对象则未必
		- 如果该对象没有逃离方法的作用访问，它是线程安全的
		- 如果该对象逃离方法的作用范围，变得在多线程共享，需要考虑。逃逸的几种情况：
			- 返回值暴露：使局部变量成为方法的返回结果
			- 将局部对象引用赋值给类成员变量或静态变量
			- 将局部对象作为参数传递给其他方法
				- 特别是传递给外星方法
					- 外星方法：行为不确定的方法（可以被子类覆盖的方法）
			- 在匿名内部类或Lambda表达式中使用外部局部变量会导致该变量所引用的对象发生逃逸
				- 示例：启动新线程时，在`Runnable`实现中使用了当前方法的局部对象引用
