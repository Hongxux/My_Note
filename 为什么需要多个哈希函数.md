---
aliases:
  - 多个哈希函数
---
**核心目的：通过多个哈希函数得到多个位置，要求多个位置同时为1才能判断为存在，降低了误判率（在相同位空间的情况下，更低的误判率）**
### 单个哈希函数的困境

想象一下，如果布隆过滤器只使用一个哈希函数：

- 当要判断一个元素是否存在时，它只需检查位数组中的**一个位置**。
    
- 这个位置为1，并不意味着目标元素一定存在，因为完全可能是**另一个不同的元素**通过哈希函数后，恰好映射到了同一个位置（即发生了哈希冲突）。
    
- 在这种情况下，布隆过滤器会错误地认为元素存在，造成误判。从流程图可以看出，单一哈希函数下，判断“可能存在”的路径非常“宽”，导致误判率很高。
    

### 多个哈希函数如何协同工作

使用多个（例如k个）相互独立的哈希函数，是对上述问题的有效改进。它的巧妙之处在于：

1. **引入“与”逻辑，大幅降低巧合概率**
    
    此时，布隆过滤器要求这个元素对应的**k个位置必须全部为1**，才会判断为“可能存在”。这意味着，只有当这k个位置**恰好都被其他元素**的设置操作所覆盖时，误判才会发生。k个位置同时被占用的概率，远低于单个位置被占用的概率。从流程图上可以看到，判断“可能存在”需要满足更严格的条件。
    
2. **空间效率与准确性的平衡艺术**
    
    多个哈希函数使得每个元素在位数组中占据的信息点更多（k个位），这看起来似乎更浪费空间。但事实上，正是这种“冗余”使得在**相同的误判率要求下，布隆过滤器所需的总位数组大小（m）可以显著减少**，或者在**相同的空间大小下，能获得低得多的误判率**。这是一种以“多点标记”换取“整体空间优化和准确性提升”的经典权衡。
    
3. **哈希函数个数并非越多越好**
    
    虽然增加哈希函数个数（k）可以降低误判率，但这也存在一个临界点。如果k过大，会导致每个元素都会标记大量的位，使得位数组很快被填满，反而**加剧误判**。同时，每增加一个哈希函数，都会增加计算开销。因此，在实际设计中，会根据预期的元素数量（n）和期望的误判率（p），通过数学公式计算出最优的k值和位数组大小m。
    

### 核心总结

简单来说，布隆过滤器使用多个哈希函数，相当于让每个元素在“入职”时同时在多份考勤表上打卡。如果有人想冒充该员工，他必须能同时在所有这些考勤表上伪造出该员工的打卡记录，这个难度显然比只伪造一份记录要大得多。

这种设计使得布隆过滤器能够以极小的空间开销，实现高效的存在性判断，尤其适合用于**缓存穿透保护**、**恶意网址拦截**等允许小概率误判的场景。其核心优势在于：**判断“不存在”是绝对准确的，而判断“存在”虽然不绝对，但通过多个哈希函数的共同作用，可以将误判率控制在很低的水平**。